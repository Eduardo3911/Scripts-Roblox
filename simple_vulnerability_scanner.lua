-- üõ°Ô∏è SIMPLE VULNERABILITY SCANNER - SEM ERROS üõ°Ô∏è
-- Vers√£o simplificada e segura

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Lista de vulnerabilidades encontradas
local vulnerabilities = {}

-- Fun√ß√£o segura para adicionar vulnerabilidade
local function addVuln(tipo, nome, local_obj)
    table.insert(vulnerabilities, {
        tipo = tipo,
        nome = nome,
        local_obj = local_obj
    })
end

-- Fun√ß√£o segura para escanear
local function scanSafe()
    vulnerabilities = {} -- Limpar lista
    
    print("üîç Iniciando scan simples...")
    
    -- 1. Verificar FilteringEnabled
    pcall(function()
        if not Workspace.FilteringEnabled then
            addVuln("CR√çTICO", "FilteringEnabled DESATIVADO", "Workspace")
        else
            print("‚úÖ FilteringEnabled est√° ativo")
        end
    end)
    
    -- 2. Procurar RemoteEvents suspeitos
    pcall(function()
        local nomesSuspeitos = {"admin", "money", "cash", "give", "ban", "kick", "teleport", "god", "fly"}
        
        for _, obj in pairs(ReplicatedStorage:GetChildren()) do
            if obj:IsA("RemoteEvent") then
                for _, suspeito in pairs(nomesSuspeitos) do
                    if string.find(string.lower(obj.Name), suspeito) then
                        addVuln("ALTO", "RemoteEvent suspeito: " .. obj.Name, "ReplicatedStorage")
                    end
                end
            end
        end
    end)
    
    -- 3. Procurar valores suspeitos
    pcall(function()
        local valoresSuspeitos = {"money", "cash", "level", "admin", "mod", "owner"}
        
        for _, obj in pairs(ReplicatedStorage:GetChildren()) do
            if obj:IsA("IntValue") or obj:IsA("StringValue") or obj:IsA("NumberValue") then
                for _, suspeito in pairs(valoresSuspeitos) do
                    if string.find(string.lower(obj.Name), suspeito) then
                        addVuln("ALTO", "Valor suspeito: " .. obj.Name, "ReplicatedStorage")
                    end
                end
            end
        end
    end)
    
    -- 4. Verificar _G (vers√£o segura)
    pcall(function()
        local count = 0
        for k, v in pairs(_G) do
            count = count + 1
            if count > 50 then break end -- Evitar loop infinito
            
            local keyStr = tostring(k)
            if string.find(string.lower(keyStr), "admin") or 
               string.find(string.lower(keyStr), "hack") then
                addVuln("M√âDIO", "Global suspeito: " .. keyStr, "_G")
            end
        end
    end)
    
    print("‚úÖ Scan completo! Encontradas " .. #vulnerabilities .. " vulnerabilidades")
    return #vulnerabilities
end

-- Interface SUPER simples
local function criarInterface()
    pcall(function()
        -- Destruir interface anterior se existir
        local antiga = playerGui:FindFirstChild("SimpleScan")
        if antiga then antiga:Destroy() end
        
        -- Criar nova interface
        local gui = Instance.new("ScreenGui")
        gui.Name = "SimpleScan"
        gui.Parent = playerGui
        
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(0, 400, 0, 300)
        frame.Position = UDim2.new(0.5, -200, 0.5, -150)
        frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        frame.BorderSizePixel = 2
        frame.BorderColor3 = #vulnerabilities > 0 and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(0, 255, 0)
        frame.Parent = gui
        
        -- T√≠tulo
        local titulo = Instance.new("TextLabel")
        titulo.Size = UDim2.new(1, 0, 0, 40)
        titulo.Position = UDim2.new(0, 0, 0, 0)
        titulo.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
        titulo.BorderSizePixel = 0
        titulo.Text = "üõ°Ô∏è SCAN DE SEGURAN√áA"
        titulo.TextColor3 = Color3.fromRGB(255, 255, 255)
        titulo.TextSize = 18
        titulo.Font = Enum.Font.SourceSansBold
        titulo.Parent = frame
        
        -- Resultado
        local resultado = Instance.new("TextLabel")
        resultado.Size = UDim2.new(1, -20, 0, 40)
        resultado.Position = UDim2.new(0, 10, 0, 50)
        resultado.BackgroundTransparency = 1
        
        if #vulnerabilities == 0 then
            resultado.Text = "‚úÖ SEGURO: Nenhuma vulnerabilidade encontrada!"
            resultado.TextColor3 = Color3.fromRGB(0, 255, 0)
        else
            resultado.Text = "‚ö†Ô∏è ENCONTRADAS: " .. #vulnerabilities .. " vulnerabilidades"
            resultado.TextColor3 = Color3.fromRGB(255, 100, 100)
        end
        
        resultado.TextSize = 16
        resultado.Font = Enum.Font.SourceSans
        resultado.TextWrapped = true
        resultado.Parent = frame
        
        -- Lista de vulnerabilidades
        local lista = Instance.new("ScrollingFrame")
        lista.Size = UDim2.new(1, -20, 1, -140)
        lista.Position = UDim2.new(0, 10, 0, 100)
        lista.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        lista.BorderSizePixel = 1
        lista.BorderColor3 = Color3.fromRGB(100, 100, 100)
        lista.ScrollBarThickness = 10
        lista.Parent = frame
        
        -- Adicionar vulnerabilidades √† lista
        for i, vuln in ipairs(vulnerabilities) do
            local item = Instance.new("TextLabel")
            item.Size = UDim2.new(1, -10, 0, 30)
            item.Position = UDim2.new(0, 5, 0, (i-1) * 35)
            item.BackgroundTransparency = 1
            item.Text = string.format("[%s] %s", vuln.tipo, vuln.nome)
            item.TextColor3 = Color3.fromRGB(255, 255, 255)
            item.TextSize = 14
            item.Font = Enum.Font.SourceSans
            item.TextXAlignment = Enum.TextXAlignment.Left
            item.TextWrapped = true
            item.Parent = lista
        end
        
        lista.CanvasSize = UDim2.new(0, 0, 0, #vulnerabilities * 35)
        
        -- Bot√£o fechar
        local fechar = Instance.new("TextButton")
        fechar.Size = UDim2.new(0, 60, 0, 30)
        fechar.Position = UDim2.new(1, -70, 1, -40)
        fechar.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
        fechar.BorderSizePixel = 0
        fechar.Text = "Fechar"
        fechar.TextColor3 = Color3.fromRGB(255, 255, 255)
        fechar.TextSize = 14
        fechar.Font = Enum.Font.SourceSans
        fechar.Parent = frame
        
        fechar.MouseButton1Click:Connect(function()
            gui:Destroy()
        end)
        
        print("‚úÖ Interface criada com sucesso!")
    end)
end

-- Fun√ß√£o principal SEGURA
local function executarScan()
    print("üöÄ Iniciando Vulnerability Scanner Simples...")
    
    local sucesso, erro = pcall(function()
        local total = scanSafe()
        wait(1)
        criarInterface()
        
        -- Mostrar no console tamb√©m
        print("\nüìã RELAT√ìRIO:")
        print("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê")
        
        if #vulnerabilities == 0 then
            print("‚úÖ JOGO SEGURO!")
        else
            for i, vuln in ipairs(vulnerabilities) do
                print(string.format("%d. [%s] %s", i, vuln.tipo, vuln.nome))
            end
        end
        print("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê")
    end)
    
    if not sucesso then
        print("‚ùå Erro no scanner: " .. tostring(erro))
        
        -- Interface de erro
        local gui = Instance.new("ScreenGui")
        gui.Name = "ScanError"
        gui.Parent = playerGui
        
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(0, 300, 0, 100)
        frame.Position = UDim2.new(0.5, -150, 0.5, -50)
        frame.BackgroundColor3 = Color3.fromRGB(100, 0, 0)
        frame.BorderSizePixel = 0
        frame.Parent = gui
        
        local texto = Instance.new("TextLabel")
        texto.Size = UDim2.new(1, 0, 1, 0)
        texto.BackgroundTransparency = 1
        texto.Text = "‚ùå Erro no scanner\nVerifique o console (F9)"
        texto.TextColor3 = Color3.fromRGB(255, 255, 255)
        texto.TextSize = 16
        texto.Font = Enum.Font.SourceSans
        texto.Parent = frame
        
        wait(5)
        gui:Destroy()
    end
end

-- Executar automaticamente
spawn(function()
    wait(3)
    executarScan()
end)

-- Exportar para uso manual
_G.SimpleScan = {
    run = executarScan
}

print("üõ°Ô∏è Simple Vulnerability Scanner carregado!")
print("üíª Se der erro, use: _G.SimpleScan.run()")