-- ğŸ•µï¸ STEALTH VULNERABILITY SCANNER - DETECTA NOMES ESCONDIDOS ğŸ•µï¸
-- Scanner avanÃ§ado que encontra vulnerabilidades disfarÃ§adas

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local stealthFindings = {}

-- Adicionar descoberta stealth
local function addStealth(category, name, location, suspicion, pattern, details)
    table.insert(stealthFindings, {
        category = category,
        name = name,
        location = location,
        suspicion = suspicion, -- CRITICAL, HIGH, MEDIUM, LOW
        pattern = pattern,
        details = details
    })
end

-- ANÃLISE DE PADRÃ•ES SUSPEITOS
local function analyzeSuspiciousPatterns()
    print("ğŸ” Analisando padrÃµes suspeitos...")
    
    -- 1. PADRÃ•ES DE NOMES SUSPEITOS (nÃ£o Ã³bvios)
    local suspiciousPatterns = {
        -- PadrÃµes de economia/dinheiro disfarÃ§ados
        {"currency", "coin", "gem", "point", "credit", "token", "balance", "wallet", "bank", "vault"},
        {"cash", "dollar", "euro", "robux", "gold", "silver", "diamond", "crystal", "orb"},
        {"fund", "asset", "resource", "treasure", "loot", "reward", "prize", "bonus"},
        
        -- PadrÃµes de admin/moderaÃ§Ã£o disfarÃ§ados  
        {"manage", "control", "handle", "process", "execute", "perform", "operate", "run"},
        {"command", "cmd", "action", "task", "job", "work", "service", "utility"},
        {"system", "core", "main", "master", "super", "ultra", "mega", "pro"},
        
        -- PadrÃµes de teleporte/movimento
        {"move", "goto", "warp", "jump", "shift", "transport", "transfer", "send"},
        {"position", "location", "place", "spot", "point", "coordinate", "zone"},
        
        -- PadrÃµes de level/progressÃ£o
        {"level", "rank", "tier", "grade", "stage", "phase", "progress", "advance"},
        {"exp", "experience", "skill", "ability", "power", "strength", "energy"},
        
        -- PadrÃµes de controle de jogador
        {"player", "user", "client", "character", "avatar", "entity", "unit"},
        {"health", "damage", "life", "hp", "mp", "stamina", "mana", "shield"}
    }
    
    local function scanPatterns(container, path)
        for _, obj in pairs(container:GetChildren()) do
            if obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") or 
               obj:IsA("IntValue") or obj:IsA("StringValue") or obj:IsA("NumberValue") then
                
                local objName = string.lower(obj.Name)
                
                -- Verificar cada padrÃ£o
                for categoryIndex, patternGroup in ipairs(suspiciousPatterns) do
                    for _, pattern in ipairs(patternGroup) do
                        if string.find(objName, pattern) then
                            local suspicionLevel = "MEDIUM"
                            local category = "Hidden Pattern"
                            local patternType = ""
                            
                            if categoryIndex == 1 then
                                patternType = "ğŸ’° Economia DisfarÃ§ada"
                                suspicionLevel = "HIGH"
                            elseif categoryIndex == 2 then
                                patternType = "ğŸ’ Sistema MonetÃ¡rio"
                                suspicionLevel = "HIGH"
                            elseif categoryIndex == 3 then
                                patternType = "ğŸ Sistema de Recompensas"
                                suspicionLevel = "MEDIUM"
                            elseif categoryIndex == 4 then
                                patternType = "âš™ï¸ Sistema de Controle"
                                suspicionLevel = "HIGH"
                            elseif categoryIndex == 5 then
                                patternType = "ğŸ“‹ Sistema de Comandos"
                                suspicionLevel = "HIGH"
                            elseif categoryIndex == 6 then
                                patternType = "ğŸ”§ Sistema Principal"
                                suspicionLevel = "MEDIUM"
                            elseif categoryIndex == 7 then
                                patternType = "ğŸš€ Sistema de Movimento"
                                suspicionLevel = "MEDIUM"
                            elseif categoryIndex == 8 then
                                patternType = "ğŸ“ Sistema de PosiÃ§Ã£o"
                                suspicionLevel = "MEDIUM"
                            elseif categoryIndex == 9 then
                                patternType = "ğŸ“ˆ Sistema de ProgressÃ£o"
                                suspicionLevel = "HIGH"
                            elseif categoryIndex == 10 then
                                patternType = "â­ Sistema de ExperiÃªncia"
                                suspicionLevel = "HIGH"
                            elseif categoryIndex == 11 then
                                patternType = "ğŸ‘¤ Sistema de Jogador"
                                suspicionLevel = "MEDIUM"
                            elseif categoryIndex == 12 then
                                patternType = "â¤ï¸ Sistema de Vida/Dano"
                                suspicionLevel = "MEDIUM"
                            end
                            
                            addStealth(category, obj.Name, path, suspicionLevel, 
                                      patternType, "ContÃ©m palavra suspeita: '" .. pattern .. "'")
                            break
                        end
                    end
                end
            end
            
            if #obj:GetChildren() > 0 then
                scanPatterns(obj, path .. "/" .. obj.Name)
            end
        end
    end
    
    scanPatterns(ReplicatedStorage, "ReplicatedStorage")
    scanPatterns(Workspace, "Workspace")
end

-- ANÃLISE DE ESTRUTURAS SUSPEITAS
local function analyzeStructuralPatterns()
    print("ğŸ” Analisando estruturas suspeitas...")
    
    -- 2. DETECTAR ESTRUTURAS ORGANIZACIONAIS SUSPEITAS
    local function scanSuspiciousStructures(container, path)
        for _, obj in pairs(container:GetChildren()) do
            -- Detectar pastas com muitos RemoteEvents
            if obj:IsA("Folder") then
                local remoteCount = 0
                local valueCount = 0
                
                for _, child in pairs(obj:GetChildren()) do
                    if child:IsA("RemoteEvent") or child:IsA("RemoteFunction") then
                        remoteCount = remoteCount + 1
                    elseif child:IsA("IntValue") or child:IsA("StringValue") or child:IsA("NumberValue") then
                        valueCount = valueCount + 1
                    end
                end
                
                -- Pasta com muitos RemoteEvents = suspeita
                if remoteCount >= 5 then
                    addStealth("Structural", obj.Name, path, "HIGH", 
                              "ğŸ“ Pasta com Muitos Remotes", 
                              string.format("ContÃ©m %d RemoteEvents (possÃ­vel hub de comandos)", remoteCount))
                end
                
                -- Pasta com muitos Values = suspeita  
                if valueCount >= 8 then
                    addStealth("Structural", obj.Name, path, "MEDIUM", 
                              "ğŸ“Š Pasta com Muitos Values", 
                              string.format("ContÃ©m %d Values (possÃ­vel sistema de dados)", valueCount))
                end
            end
            
            if #obj:GetChildren() > 0 then
                scanSuspiciousStructures(obj, path .. "/" .. obj.Name)
            end
        end
    end
    
    scanSuspiciousStructures(ReplicatedStorage, "ReplicatedStorage")
end

-- ANÃLISE DE NOMES CODIFICADOS
local function analyzeEncodedNames()
    print("ğŸ” Analisando nomes codificados...")
    
    -- 3. DETECTAR NOMES CODIFICADOS/ENCRIPTADOS
    local function scanEncodedNames(container, path)
        for _, obj in pairs(container:GetChildren()) do
            if obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") or 
               obj:IsA("IntValue") or obj:IsA("StringValue") or obj:IsA("NumberValue") then
                
                local name = obj.Name
                
                -- Detectar padrÃµes de codificaÃ§Ã£o
                local suspiciousNamePatterns = {
                    -- Nomes muito curtos (possÃ­vel cÃ³digo)
                    {pattern = "^[A-Za-z]{1,2}$", reason = "Nome muito curto (cÃ³digo?)", level = "LOW"},
                    
                    -- Nomes com nÃºmeros no meio (suspeito)
                    {pattern = "[A-Za-z]+%d+[A-Za-z]+", reason = "PadrÃ£o alfanumÃ©rico suspeito", level = "MEDIUM"},
                    
                    -- Nomes com underscores mÃºltiplos
                    {pattern = ".*__.*", reason = "MÃºltiplos underscores (padrÃ£o de sistema)", level = "MEDIUM"},
                    
                    -- Nomes em CAPS (possÃ­vel importÃ¢ncia)
                    {pattern = "^[A-Z_]+$", reason = "Todo em maiÃºsculas (sistema importante?)", level = "LOW"},
                    
                    -- Nomes com padrÃ£o hexadecimal
                    {pattern = "^[A-Fa-f0-9]+$", reason = "PadrÃ£o hexadecimal (ID codificado?)", level = "HIGH"},
                    
                    -- Nomes Base64-like
                    {pattern = "^[A-Za-z0-9+/]+={0,2}$", reason = "PossÃ­vel Base64", level = "MEDIUM"},
                    
                    -- Nomes reversed (palavras ao contrÃ¡rio)
                    {pattern = ".*", reason = "", level = "MEDIUM"} -- Processado especialmente abaixo
                }
                
                for _, namePattern in ipairs(suspiciousNamePatterns) do
                    if namePattern.pattern ~= ".*" and string.match(name, namePattern.pattern) then
                        addStealth("Encoded Name", name, path, namePattern.level, 
                                  "ğŸ” Nome Codificado", namePattern.reason)
                        break
                    end
                end
                
                -- Verificar palavras reversed (ao contrÃ¡rio)
                local commonWords = {"admin", "money", "cash", "give", "take", "user", "player", "level"}
                for _, word in ipairs(commonWords) do
                    local reversed = string.reverse(word)
                    if string.lower(name) == reversed then
                        addStealth("Encoded Name", name, path, "HIGH", 
                                  "ğŸ”„ Palavra Invertida", 
                                  "Nome Ã© '" .. word .. "' ao contrÃ¡rio!")
                    end
                end
                
                -- Verificar ROT13 simples
                local function simpleRot13(str)
                    return str:gsub("[A-Za-z]", function(c)
                        local offset = c:match("[A-Z]") and 65 or 97
                        return string.char((c:byte() - offset + 13) % 26 + offset)
                    end)
                end
                
                local rot13Name = simpleRot13(string.lower(name))
                for _, word in ipairs(commonWords) do
                    if rot13Name == word then
                        addStealth("Encoded Name", name, path, "HIGH", 
                                  "ğŸ”€ ROT13 Encoding", 
                                  "Nome decodifica para: " .. word)
                    end
                end
            end
            
            if #obj:GetChildren() > 0 then
                scanEncodedNames(obj, path .. "/" .. obj.Name)
            end
        end
    end
    
    scanEncodedNames(ReplicatedStorage, "ReplicatedStorage")
end

-- ANÃLISE DE VALORES SUSPEITOS
local function analyzeValuePatterns()
    print("ğŸ” Analisando padrÃµes de valores...")
    
    -- 4. ANALISAR VALORES REAIS DOS OBJECTS
    local function scanValueContents(container, path)
        for _, obj in pairs(container:GetChildren()) do
            -- Analisar IntValues com valores suspeitos
            if obj:IsA("IntValue") then
                local value = obj.Value
                
                -- Valores tÃ­picos de dinheiro/level
                if value == 1000 or value == 5000 or value == 10000 or value == 50000 or value == 100000 then
                    addStealth("Suspicious Value", obj.Name, path, "MEDIUM", 
                              "ğŸ’° Valor MonetÃ¡rio TÃ­pico", 
                              "Valor = " .. value .. " (comum em sistemas de dinheiro)")
                end
                
                -- Valores de level tÃ­picos
                if value >= 1 and value <= 100 and value % 5 == 0 then
                    addStealth("Suspicious Value", obj.Name, path, "LOW", 
                              "ğŸ“ˆ PossÃ­vel Level/Rank", 
                              "Valor = " .. value .. " (tÃ­pico de sistema de levels)")
                end
            end
            
            -- Analisar StringValues com conteÃºdo suspeito
            if obj:IsA("StringValue") then
                local value = string.lower(obj.Value)
                local suspiciousStrings = {"true", "false", "enabled", "disabled", "admin", "mod", "owner"}
                
                for _, susStr in ipairs(suspiciousStrings) do
                    if value == susStr then
                        addStealth("Suspicious Value", obj.Name, path, "MEDIUM", 
                                  "ğŸ”§ String de ConfiguraÃ§Ã£o", 
                                  "Valor = '" .. obj.Value .. "' (configuraÃ§Ã£o de sistema)")
                    end
                end
            end
            
            if #obj:GetChildren() > 0 then
                scanValueContents(obj, path .. "/" .. obj.Name)
            end
        end
    end
    
    scanValueContents(ReplicatedStorage, "ReplicatedStorage")
end

-- ANÃLISE DE GLOBALS AVANÃ‡ADA
local function analyzeAdvancedGlobals()
    print("ğŸ” Analisando variÃ¡veis globais avanÃ§adas...")
    
    -- 5. ANÃLISE PROFUNDA DE _G e shared
    local globalCount = 0
    for k, v in pairs(_G) do
        globalCount = globalCount + 1
        if globalCount > 100 then break end
        
        local keyStr = tostring(k)
        local valueType = type(v)
        
        -- Detectar funÃ§Ãµes com nomes suspeitos (nÃ£o Ã³bvios)
        if valueType == "function" then
            local lowerKey = string.lower(keyStr)
            
            -- PadrÃµes de funÃ§Ã£o suspeitos
            if string.find(lowerKey, "update") or string.find(lowerKey, "set") or 
               string.find(lowerKey, "get") or string.find(lowerKey, "change") or
               string.find(lowerKey, "modify") or string.find(lowerKey, "handle") then
                addStealth("Global Function", keyStr, "_G", "MEDIUM", 
                          "ğŸ”§ FunÃ§Ã£o de Sistema", 
                          "FunÃ§Ã£o global que pode modificar dados")
            end
        end
        
        -- Detectar tabelas grandes (possÃ­veis sistemas)
        if valueType == "table" then
            local success, tableSize = pcall(function()
                local count = 0
                for _ in pairs(v) do count = count + 1 end
                return count
            end)
            
            if success and tableSize > 10 then
                addStealth("Global Table", keyStr, "_G", "LOW", 
                          "ğŸ“Š Tabela Grande", 
                          "Tabela com " .. tableSize .. " entradas (possÃ­vel sistema)")
            end
        end
    end
end

-- INTERFACE STEALTH
local function createStealthGUI(findings)
    local gui = Instance.new("ScreenGui")
    gui.Name = "StealthScan"
    gui.Parent = playerGui
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 600, 0, 500)
    frame.Position = UDim2.new(0.5, -300, 0.5, -250)
    frame.BackgroundColor3 = Color3.fromRGB(15, 15, 20)
    frame.BorderSizePixel = 2
    frame.BorderColor3 = Color3.fromRGB(100, 50, 200)
    frame.Parent = gui
    
    -- TÃ­tulo stealth
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 50)
    title.BackgroundColor3 = Color3.fromRGB(30, 15, 40)
    title.BorderSizePixel = 0
    title.Text = "ğŸ•µï¸ STEALTH VULNERABILITY SCANNER"
    title.TextColor3 = Color3.fromRGB(200, 150, 255)
    title.TextSize = 16
    title.Font = Enum.Font.SourceSansBold
    title.Parent = frame
    
    -- EstatÃ­sticas
    local stats = Instance.new("TextLabel")
    stats.Size = UDim2.new(1, -20, 0, 30)
    stats.Position = UDim2.new(0, 10, 0, 55)
    stats.BackgroundTransparency = 1
    stats.Text = string.format("ğŸ” %d padrÃµes suspeitos detectados", #findings)
    stats.TextColor3 = Color3.fromRGB(255, 255, 255)
    stats.TextSize = 14
    stats.Font = Enum.Font.SourceSans
    stats.Parent = frame
    
    -- ScrollFrame para resultados
    local scroll = Instance.new("ScrollingFrame")
    scroll.Size = UDim2.new(1, -20, 1, -125)
    scroll.Position = UDim2.new(0, 10, 0, 90)
    scroll.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
    scroll.BorderSizePixel = 1
    scroll.BorderColor3 = Color3.fromRGB(60, 60, 70)
    scroll.ScrollBarThickness = 8
    scroll.Parent = frame
    
    -- Agrupar por categoria
    local categories = {}
    for _, finding in ipairs(findings) do
        if not categories[finding.category] then
            categories[finding.category] = {}
        end
        table.insert(categories[finding.category], finding)
    end
    
    local yPos = 5
    for category, categoryFindings in pairs(categories) do
        -- CabeÃ§alho da categoria
        local categoryHeader = Instance.new("TextLabel")
        categoryHeader.Size = UDim2.new(1, -10, 0, 25)
        categoryHeader.Position = UDim2.new(0, 5, 0, yPos)
        categoryHeader.BackgroundColor3 = Color3.fromRGB(50, 30, 70)
        categoryHeader.BorderSizePixel = 0
        categoryHeader.Text = "ğŸ“ " .. category .. " (" .. #categoryFindings .. ")"
        categoryHeader.TextColor3 = Color3.fromRGB(200, 150, 255)
        categoryHeader.TextSize = 13
        categoryHeader.Font = Enum.Font.SourceSansBold
        categoryHeader.TextXAlignment = Enum.TextXAlignment.Left
        categoryHeader.Parent = scroll
        
        yPos = yPos + 30
        
        -- Items da categoria
        for _, finding in ipairs(categoryFindings) do
            local item = Instance.new("TextLabel")
            item.Size = UDim2.new(1, -20, 0, 50)
            item.Position = UDim2.new(0, 15, 0, yPos)
            item.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
            item.BorderSizePixel = 0
            
            -- Cores por suspeiÃ§Ã£o
            local suspicionColors = {
                CRITICAL = Color3.fromRGB(255, 100, 100),
                HIGH = Color3.fromRGB(255, 150, 100),
                MEDIUM = Color3.fromRGB(255, 200, 100),
                LOW = Color3.fromRGB(200, 200, 200)
            }
            
            item.Text = string.format("â€¢ [%s] %s\n  %s\n  ğŸ’¡ %s", 
                finding.suspicion, finding.name, finding.pattern, finding.details)
            item.TextColor3 = suspicionColors[finding.suspicion] or Color3.fromRGB(255, 255, 255)
            item.TextSize = 11
            item.Font = Enum.Font.SourceSans
            item.TextXAlignment = Enum.TextXAlignment.Left
            item.TextYAlignment = Enum.TextYAlignment.Top
            item.TextWrapped = true
            item.Parent = scroll
            
            yPos = yPos + 55
        end
        
        yPos = yPos + 10
    end
    
    scroll.CanvasSize = UDim2.new(0, 0, 0, yPos)
    
    -- BotÃ£o fechar
    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 80, 0, 25)
    closeBtn.Position = UDim2.new(1, -90, 1, -35)
    closeBtn.BackgroundColor3 = Color3.fromRGB(100, 50, 150)
    closeBtn.BorderSizePixel = 0
    closeBtn.Text = "Fechar"
    closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeBtn.TextSize = 12
    closeBtn.Font = Enum.Font.SourceSans
    closeBtn.Parent = frame
    
    closeBtn.MouseButton1Click:Connect(function()
        gui:Destroy()
    end)
end

-- SCANNER PRINCIPAL STEALTH
local function runStealthScan()
    print("ğŸ•µï¸ Iniciando STEALTH VULNERABILITY SCAN...")
    print("ğŸ” Procurando vulnerabilidades com nomes ESCONDIDOS...")
    
    stealthFindings = {}
    
    -- Executar todas as anÃ¡lises
    analyzeSuspiciousPatterns()
    analyzeStructuralPatterns()
    analyzeEncodedNames()
    analyzeValuePatterns()
    analyzeAdvancedGlobals()
    
    -- Mostrar interface
    createStealthGUI(stealthFindings)
    
    -- RelatÃ³rio no console
    print("\nğŸ•µï¸ RELATÃ“RIO STEALTH:")
    print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    if #stealthFindings == 0 then
        print("ğŸ›¡ï¸ Impressionante! Nenhum padrÃ£o suspeito detectado!")
        print("ğŸ† Este jogo tem seguranÃ§a MUITO boa ou Ã© muito simples")
    else
        print("ğŸš¨ PADRÃ•ES SUSPEITOS ENCONTRADOS:")
        
        local severityCount = {CRITICAL = 0, HIGH = 0, MEDIUM = 0, LOW = 0}
        
        for _, finding in ipairs(stealthFindings) do
            severityCount[finding.suspicion] = severityCount[finding.suspicion] + 1
            print(string.format("[%s] %s - %s", finding.suspicion, finding.name, finding.pattern))
        end
        
        print("\nğŸ“Š RESUMO:")
        print("ğŸ”´ CRÃTICOS: " .. severityCount.CRITICAL)
        print("ğŸŸ  ALTOS: " .. severityCount.HIGH)
        print("ğŸŸ¡ MÃ‰DIOS: " .. severityCount.MEDIUM)
        print("âšª BAIXOS: " .. severityCount.LOW)
    end
    
    print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    print("ğŸ¯ Stealth scan concluÃ­do!")
end

-- Auto-executar
spawn(function()
    wait(3)
    runStealthScan()
end)

_G.StealthScan = runStealthScan

print("ğŸ•µï¸ Stealth Vulnerability Scanner carregado!")
print("ğŸ” Este scanner encontra vulnerabilidades com nomes DISFARÃ‡ADOS!")
print("ğŸ’» Uso manual: _G.StealthScan()")